<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RNL FOOD • Ришельевский лицей</title>
    <meta name="theme-color" content="#00b377">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="logo.svg" type="image/svg+xml">

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode.js@1.0.0/qrcode.min.js"></script>
</head>
<body class="light-theme">

<!-- Header -->
<header class="header">
    <div class="container">
        <div class="header-content">
            <div class="logo-section">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%2300b377'/%3E%3Ctext x='50' y='60' font-size='30' fill='white' text-anchor='middle'%3ERNL%3C/text%3E%3C/svg%3E" alt="RNL" class="logo">
                <div>
                    <div class="logo-text">Ришельевский Лицей</div>
                    <div class="logo-subtext">Сервис питания • 2025</div>
                </div>
            </div>
            <div class="header-actions">
                <button class="theme-toggle" id="theme-toggle" title="Темная тема">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="points-badge" id="points-badge" style="display:none;">
                    <i class="fas fa-star"></i> <span id="user-points">0</span>
                </div>
                <button class="btn-particle" onclick="openModal('promo-modal')">
                    <i class="fas fa-tag"></i> Промокод
                </button>
                <div class="cart-icon" onclick="goTo('assortment')">
                    <i class="fas fa-shopping-basket"></i>
                    <span id="cart-count" class="cart-count">0</span>
                </div>
                <div class="avatar" onclick="goTo('profile')">
                    <i class="fas fa-user-circle fa-2x"></i>
                </div>
                <button class="logout-btn" id="logout-btn" onclick="logout()" style="display:none">Выйти</button>
                <button class="admin-btn" id="admin-btn" onclick="goTo('admin')" style="display:none">Админка</button>
            </div>
        </div>
    </div>
</header>

<main class="main-content">
    <div class="container">

        <!-- Старт -->
        <section id="start" class="screen active">
            <div class="hero">
                <h1 class="hero-title">РНЛ <span class="highlight">ЕДА</span> 2025</h1>
                <p class="hero-subtitle">Быстрый заказ • Без очередей • Вкусно и по-новому</p>
                <div class="btn-contain">
                    <button class="btn-primary btn-particle big" onclick="goTo('login')">ВОЙТИ</button>
                </div>
            </div>
            <div class="authors">© Даниленко Даниил • Дмитриев Николай • 2025</div>
        </section>

        <!-- Вход -->
        <section id="login" class="screen">
            <div class="auth-card">
                <h2>Вход в аккаунт</h2>
                <div class="input-group">
                    <input type="text" id="username" placeholder=" " required>
                    <label>Логин</label>
                </div>
                <div class="input-group">
                    <input type="password" id="password" placeholder=" " required>
                    <label>Пароль</label>
                </div>
                <button class="btn-primary btn-particle" onclick="login()">ВОЙТИ</button>
                <p class="link" onclick="openModal('register-modal')">Нет аккаунта? Зарегистрироваться</p>
            </div>
        </section>

        <!-- Профиль -->
        <section id="profile" class="screen">
            <h2 id="welcome">Привет, <span id="profile-name">-</span>!</h2>
            <div class="balance-card big">
                <div>
                    <div class="label">Баланс</div>
                    <div class="balance-amount" id="balance">0.00 ₴</div>
                    <div class="points-small">+<span id="profile-points">0</span> ★ баллов</div>
                </div>
                <button class="btn-secondary" onclick="goTo('payment')">Пополнить</button>
            </div>

            <div class="grid-2">
                <div class="card">
                    <h3>Данные</h3>
                    <p><strong>Класс:</strong> <span id="profile-grade">-</span></p>
                    <p><strong>Возраст:</strong> <span id="profile-age">-</span></p>
                    <p><strong>Родители:</strong> <span id="profile-parents">-</span></p>
                    <p><strong>Аллергены:</strong> <span id="profile-allergens">Нет</span></p>
                </div>
                <div class="card">
                    <h3>Любимые блюда</h3>
                    <div id="favorite-meals-list" class="favorite-grid">
                        <p class="empty">Нажми сердечко на блюде</p>
                    </div>
                </div>
            </div>

            <button class="btn-primary full" onclick="goTo('assortment')">Заказать еду</button>
        </section>

        <!-- Ассортимент -->
        <section id="assortment" class="screen">
            <div class="page-header">
                <h2>Меню на <span id="menu-date">сегодня</span></h2>
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-input" placeholder="Поиск...">
                </div>
            </div>

            <div class="categories" id="categories-list">
                <button class="category-btn active" data-category="all">Все</button>
            </div>

            <div class="meals-grid" id="items-container"></div>

            <div class="cart-floating" id="cart-summary">
                <div class="cart-header">
                    <h3>Корзина (<span id="cart-items-count">0</span>)</h3>
                    <button onclick="clearCart()">Очистить</button>
                </div>
                <div id="cart-items"></div>
                <div class="totals">
                    <div>Сумма: <span id="cart-total">0 ₴</span></div>
                    <div id="discount-line" style="display:none">Скидка: −<span id="discount-amount">0</span> ₴</div>
                    <div class="final">К оплате: <span id="final-total">0 ₴</span></div>
                    <div class="calories-info" id="calories-info">Калорий: 0 ккал</div>
                </div>
                <button class="btn-primary full" onclick="placeOrder()">Оформить заказ</button>
            </div>
        </section>

        <!-- Спасибо за заказ -->
        <section id="Thx" class="screen">
            <div class="success-box">
                <i class="fas fa-check-circle success-icon"></i>
                <h2>Заказ №<span id="order-number"></span> принят!</h2>
                <p>Готов через <span id="countdown">20</span> минут</p>
                
                <div id="order-qr" style="width:220px;height:220px;margin:30px auto;background:white;padding:10px;border-radius:12px;"></div>
                <p class="qr-text">Покажите QR в столовой</p>

                <div class="order-summary">
                    <h3>Состав заказа:</h3>
                    <div id="order-details-list"></div>
                    <div class="order-total">Итого: <strong id="order-final-total">0 ₴</strong></div>
                </div>

                <div style="margin-top:20px;">
                    <button class="btn-secondary" onclick="rateOrderPrompt()">Оценить заказ</button>
                </div>

                <button class="btn-primary" style="margin-top:15px;" onclick="goTo('assortment')">В меню</button>
            </div>
        </section>

        <!-- Пополнение, история, админка — оставлены как у тебя, но с мелкими улучшениями -->
        <!-- (если хочешь — скажи, я добавлю их тоже с новыми фичами) -->

    </div>
</main>

<!-- Модалы -->
<div id="promo-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('promo-modal')">×</span>
        <h3>Промокод</h3>
        <input type="text" id="promo-input" placeholder="WELCOME10">
        <button class="btn-primary" onclick="applyPromo()">Применить</button>
    </div>
</div>

<div id="register-modal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal('register-modal')">×</span>
        <h3>Регистрация</h3>
        <!-- Поля как в твоём оригинале -->
        <input type="text" id="reg-username" placeholder="Логин"><br><br>
        <input type="password" id="reg-password" placeholder="Пароль"><br><br>
        <input type="text" id="reg-fullname" placeholder="ФИО"><br><br>
        <input type="text" id="reg-class" placeholder="Класс"><br><br>
        <input type="number" id="reg-age" placeholder="Возраст" min="10" max="18"><br><br>
        <input type="text" id="reg-parents" placeholder="Родители"><br><br>
        <button class="btn-primary" onclick="register()">Зарегистрироваться</button>
    </div>
</div>

<!-- Уведомление -->
<div id="notification" class="notification">
    <span id="notification-text"></span>
</div>

<!-- Загрузка -->
<div id="loading" class="loading">
    <div class="spinner"></div>
    <p>Загрузка...</p>
</div>

<script src="script.js"></script>
<script>
// PWA
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>
